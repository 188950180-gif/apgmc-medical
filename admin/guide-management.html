<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è½åœ°å¯¹æ¥äººç®¡ç† - APGMC ç®¡ç†åå°</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%); min-height: 100vh; padding: 40px 20px; }
        .container { max-width: 1600px; margin: 0 auto; }
        
        /* å¤´éƒ¨ */
        .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px; flex-wrap: wrap; gap: 20px; }
        h1 { color: #1D3557; font-size: 2rem; margin-bottom: 8px; display: flex; align-items: center; gap: 12px; }
        .subtitle { color: #6C757D; font-size: 1rem; }
        
        /* ç»Ÿè®¡è¡Œ */
        .stats-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; border-radius: 16px; padding: 24px; text-align: center; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        .stat-num { font-size: 2rem; font-weight: 800; color: #006D77; }
        .stat-label { color: #6C757D; font-size: 0.9rem; margin-top: 4px; }
        
        /* åŒºåŸŸé€‰æ‹©Tab */
        .region-tabs { display: flex; gap: 8px; margin-bottom: 24px; flex-wrap: wrap; }
        .region-tab { padding: 12px 24px; border: none; background: white; border-radius: 10px; font-size: 0.95rem; font-weight: 600; cursor: pointer; transition: all 0.3s; color: #495057; }
        .region-tab:hover { background: #EDF6F9; color: #006D77; }
        .region-tab.active { background: linear-gradient(135deg, #006D77 0%, #005660 100%); color: white; }
        
        /* çœä»½å¡ç‰‡ç½‘æ ¼ */
        .province-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(450px, 1fr)); gap: 24px; }
        
        /* çœä»½å¡ç‰‡ */
        .province-card { background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.08); }
        .province-header { padding: 20px 24px; display: flex; justify-content: space-between; align-items: center; }
        .province-name { font-size: 1.3rem; font-weight: 700; color: #1D3557; }
        .province-status { padding: 8px 16px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; }
        .status-complete { background: linear-gradient(135deg, #10B981 0%, #059669 100%); color: white; }
        .status-partial { background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%); color: white; }
        .status-empty { background: #e9ecef; color: #6C757D; }
        
        .province-body { padding: 0; }
        
        /* åŒ»é™¢-å¯¹æ¥äººè¡Œ */
        .mapping-row { display: flex; border-bottom: 1px solid #f0f0f0; }
        .mapping-row:last-child { border-bottom: none; }
        .hospital-cell { flex: 1; padding: 16px 24px; border-right: 1px solid #f0f0f0; }
        .guide-cell { flex: 1; padding: 16px 24px; }
        
        .cell-title { font-size: 0.8rem; color: #6C757D; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
        
        /* åŒ»é™¢é¡¹ */
        .hospital-item { display: flex; align-items: center; gap: 12px; padding: 12px; background: #f8f9fa; border-radius: 10px; margin-bottom: 8px; }
        .hospital-item:last-child { margin-bottom: 0; }
        .hospital-icon { width: 40px; height: 40px; border-radius: 10px; background: linear-gradient(135deg, #006D77 0%, #83C5BE 100%); display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .hospital-info { flex: 1; }
        .hospital-name { font-weight: 600; color: #1D3557; font-size: 0.95rem; }
        .hospital-tags { display: flex; gap: 6px; margin-top: 4px; }
        .tag { padding: 3px 10px; background: #EDF6F9; color: #006D77; border-radius: 6px; font-size: 0.75rem; }
        
        /* å¯¹æ¥äººé¡¹ */
        .guide-item { display: flex; align-items: center; gap: 12px; padding: 12px; background: #f8f9fa; border-radius: 10px; margin-bottom: 8px; }
        .guide-item:last-child { margin-bottom: 0; }
        .guide-avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #006D77 0%, #83C5BE 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1rem; }
        .guide-info { flex: 1; }
        .guide-name { font-weight: 600; color: #1D3557; font-size: 0.95rem; }
        .guide-contact { font-size: 0.85rem; color: #6C757D; display: flex; gap: 12px; margin-top: 4px; }
        .guide-contact span { display: flex; align-items: center; gap: 4px; }
        
        /* ç©ºçŠ¶æ€ */
        .empty-state { padding: 40px; text-align: center; color: #6C757D; }
        .empty-icon { font-size: 2rem; margin-bottom: 12px; }
        
        /* æŒ‰é’® */
        .btn { padding: 14px 28px; border: none; border-radius: 12px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; display: inline-flex; align-items: center; gap: 8px; }
        .btn-primary { background: linear-gradient(135deg, #006D77 0%, #005660 100%); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,109,119,0.35); }
        .btn-secondary { background: #e9ecef; color: #495057; }
        .btn-sm { padding: 8px 16px; font-size: 0.85rem; }
        
        /* å¼¹çª— */
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center; }
        .modal.open { display: flex; }
        .modal-content { background: white; border-radius: 24px; padding: 32px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
        .modal-title { font-size: 1.4rem; color: #1D3557; }
        .modal-close { width: 40px; height: 40px; border: none; background: #e9ecef; border-radius: 50%; font-size: 1.5rem; cursor: pointer; transition: all 0.3s; }
        .modal-close:hover { background: #e74c3c; color: white; }
        
        /* è¡¨å• */
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #495057; font-size: 0.9rem; }
        .form-group label .required { color: #e74c3c; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 14px 18px; border: 2px solid #e8e8e8; border-radius: 12px; font-size: 1rem; transition: all 0.3s; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #006D77; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        
        /* Toast */
        .toast { position: fixed; bottom: 30px; right: 30px; background: #1D3557; color: white; padding: 16px 28px; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); z-index: 10001; display: none; }
        .toast.show { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        /* å›¾ä¾‹ */
        .legend { display: flex; gap: 20px; margin-bottom: 24px; flex-wrap: wrap; }
        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.9rem; color: #495057; }
        .legend-dot { width: 12px; height: 12px; border-radius: 50%; }
        .legend-dot.green { background: #10B981; }
        .legend-dot.orange { background: #F59E0B; }
        .legend-dot.gray { background: #e9ecef; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <h1>ğŸ‘¥ è½åœ°å¯¹æ¥äººç®¡ç†</h1>
                <p class="subtitle">æŒ‰åŒºåŸŸåˆ’åˆ†ï¼šåå—ã€ååŒ—ã€åä¸œã€åè¥¿ã€åä¸­ Â· ç»¿è‰²=å®Œæ•´åŒ¹é…</p>
            </div>
            <div style="display: flex; gap: 12px;">
                <button class="btn btn-secondary" onclick="openHospitalModal()">+ æ·»åŠ åŒ»é™¢</button>
                <button class="btn btn-primary" onclick="openGuideModal()">+ æ·»åŠ å¯¹æ¥äºº</button>
            </div>
        </div>
        
        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-num" id="totalRegions">5</div>
                <div class="stat-label">è¦†ç›–åŒºåŸŸ</div>
            </div>
            <div class="stat-card">
                <div class="stat-num" id="totalHospitals">3</div>
                <div class="stat-label">åˆä½œåŒ»é™¢</div>
            </div>
            <div class="stat-card">
                <div class="stat-num" id="totalGuides">4</div>
                <div class="stat-label">å¯¹æ¥äººæ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-num" id="completeMatches">0</div>
                <div class="stat-label">å®Œæ•´åŒ¹é…</div>
            </div>
        </div>
        
        <!-- å›¾ä¾‹ -->
        <div class="legend">
            <div class="legend-item">
                <div class="legend-dot green"></div>
                <span>ç»¿è‰²ï¼šåŒ»é™¢+å¯¹æ¥äººå®Œæ•´</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot orange"></div>
                <span>æ©™è‰²ï¼šä»…åŒ»é™¢æˆ–ä»…å¯¹æ¥äºº</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot gray"></div>
                <span>ç°è‰²ï¼šæœªé…ç½®</span>
            </div>
        </div>
        
        <!-- åŒºåŸŸTab -->
        <div class="region-tabs" id="regionTabs">
            <button class="region-tab active" onclick="filterRegion('all')">å…¨éƒ¨</button>
            <button class="region-tab" onclick="filterRegion('åå—')">åå—</button>
            <button class="region-tab" onclick="filterRegion('ååŒ—')">ååŒ—</button>
            <button class="region-tab" onclick="filterRegion('åä¸œ')">åä¸œ</button>
            <button class="region-tab" onclick="filterRegion('åè¥¿')">åè¥¿</button>
            <button class="region-tab" onclick="filterRegion('åä¸­')">åä¸­</button>
        </div>
        
        <!-- çœä»½ç½‘æ ¼ -->
        <div class="province-grid" id="provinceGrid">
            <!-- æ•°æ®ç”±JSåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>
    
    <!-- æ·»åŠ åŒ»é™¢å¼¹çª— -->
    <div class="modal" id="hospitalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">æ·»åŠ åŒ»é™¢</h3>
                <button class="modal-close" onclick="closeModal('hospitalModal')">Ã—</button>
            </div>
            <form onsubmit="saveHospital(event)">
                <div class="form-group">
                    <label>åŒ»é™¢åç§° <span class="required">*</span></label>
                    <input type="text" id="hospitalName" placeholder="ä¾‹å¦‚ï¼šåŒ—äº¬åå’ŒåŒ»é™¢" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>æ‰€åœ¨åŒºåŸŸ <span class="required">*</span></label>
                        <select id="hospitalRegion" required>
                            <option value="">è¯·é€‰æ‹©</option>
                            <option value="åå—">åå—</option>
                            <option value="ååŒ—">ååŒ—</option>
                            <option value="åä¸œ">åä¸œ</option>
                            <option value="åè¥¿">åè¥¿</option>
                            <option value="åä¸­">åä¸­</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>æ‰€åœ¨çœä»½ <span class="required">*</span></label>
                        <select id="hospitalProvince" required>
                            <option value="">è¯·é€‰æ‹©</option>
                            <option value="å¹¿ä¸œ">å¹¿ä¸œ</option>
                            <option value="å¹¿è¥¿">å¹¿è¥¿</option>
                            <option value="æµ·å—">æµ·å—</option>
                            <option value="åŒ—äº¬">åŒ—äº¬</option>
                            <option value="å¤©æ´¥">å¤©æ´¥</option>
                            <option value="æ²³åŒ—">æ²³åŒ—</option>
                            <option value="å±±è¥¿">å±±è¥¿</option>
                            <option value="å†…è’™å¤">å†…è’™å¤</option>
                            <option value="ä¸Šæµ·">ä¸Šæµ·</option>
                            <option value="æ±Ÿè‹">æ±Ÿè‹</option>
                            <option value="æµ™æ±Ÿ">æµ™æ±Ÿ</option>
                            <option value="å®‰å¾½">å®‰å¾½</option>
                            <option value="ç¦å»º">ç¦å»º</option>
                            <option value="æ±Ÿè¥¿">æ±Ÿè¥¿</option>
                            <option value="å±±ä¸œ">å±±ä¸œ</option>
                            <option value="å››å·">å››å·</option>
                            <option value="é‡åº†">é‡åº†</option>
                            <option value="è´µå·">è´µå·</option>
                            <option value="äº‘å—">äº‘å—</option>
                            <option value="è¥¿è—">è¥¿è—</option>
                            <option value="é™•è¥¿">é™•è¥¿</option>
                            <option value="ç”˜è‚ƒ">ç”˜è‚ƒ</option>
                            <option value="é’æµ·">é’æµ·</option>
                            <option value="å®å¤">å®å¤</option>
                            <option value="æ–°ç–†">æ–°ç–†</option>
                            <option value="æ¹–å—">æ¹–å—</option>
                            <option value="æ¹–åŒ—">æ¹–åŒ—</option>
                            <option value="æ²³å—">æ²³å—</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>è´Ÿè´£å¯¹æ¥äºº <span class="required">*</span></label>
                    <select id="hospitalGuide" required>
                        <option value="">è¯·é€‰æ‹©å¯¹æ¥äººï¼ˆå¿…é€‰ï¼‰</option>
                    </select>
                    <div class="hint" style="color: #e74c3c; font-size: 0.85rem; margin-top: 6px;">âš ï¸ æ·»åŠ åŒ»é™¢æ—¶å¿…é¡»æŒ‡å®šå¯¹æ¥äºº</div>
                </div>
                <div class="form-group">
                    <label>åŒ»é™¢ç­‰çº§</label>
                    <select id="hospitalLevel">
                        <option value="ä¸‰ç”²">ä¸‰ç”²åŒ»é™¢</option>
                        <option value="ä¸‰ä¹™">ä¸‰ä¹™åŒ»é™¢</option>
                        <option value="äºŒç”²">äºŒç”²åŒ»é™¢</option>
                        <option value="äºŒä¹™">äºŒä¹™åŒ»é™¢</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>å¤‡æ³¨</label>
                    <textarea id="hospitalNote" rows="2" placeholder="å…¶ä»–è¯´æ˜..."></textarea>
                </div>
                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('hospitalModal')">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜åŒ»é™¢</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- æ·»åŠ å¯¹æ¥äººå¼¹çª— -->
    <div class="modal" id="guideModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">æ·»åŠ å¯¹æ¥äºº</h3>
                <button class="modal-close" onclick="closeModal('guideModal')">Ã—</button>
            </div>
            <form onsubmit="saveGuide(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>å§“å <span class="required">*</span></label>
                        <input type="text" id="guideName" placeholder="è¯·è¾“å…¥å§“å" required>
                    </div>
                    <div class="form-group">
                        <label>æ€§åˆ«</label>
                        <select id="guideGender">
                            <option value="">è¯·é€‰æ‹©</option>
                            <option value="male">ç”·</option>
                            <option value="female">å¥³</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>æ‰‹æœºå·ç  <span class="required">*</span></label>
                        <input type="tel" id="guidePhone" placeholder="+86 138-xxxx-xxxx" required>
                    </div>
                    <div class="form-group">
                        <label>å…¬å¸é‚®ç®± <span class="required">*</span></label>
                        <input type="email" id="guideEmail" placeholder="name@apgmc.com" required>
                        <div class="hint" style="color: #999; font-size: 0.8rem; margin-top: 4px;">æ³¨å†Œå…¬å¸ä¸“ç”¨åŠå…¬é‚®ç®±</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>å¾®ä¿¡å·</label>
                        <input type="text" id="guideWechat" placeholder="è¯·è¾“å…¥å¾®ä¿¡å·">
                    </div>
                    <div class="form-group">
                        <label>è´Ÿè´£åŒºåŸŸ <span class="required">*</span></label>
                        <select id="guideRegion" required>
                            <option value="">è¯·é€‰æ‹©</option>
                            <option value="åå—">åå—</option>
                            <option value="ååŒ—">ååŒ—</option>
                            <option value="åä¸œ">åä¸œ</option>
                            <option value="åè¥¿">åè¥¿</option>
                            <option value="åä¸­">åä¸­</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>è´Ÿè´£çœä»½</label>
                    <select id="guideProvince" multiple style="height: 80px;">
                        <option value="å¹¿ä¸œ">å¹¿ä¸œ</option>
                        <option value="å¹¿è¥¿">å¹¿è¥¿</option>
                        <option value="æµ·å—">æµ·å—</option>
                        <option value="åŒ—äº¬">åŒ—äº¬</option>
                        <option value="å¤©æ´¥">å¤©æ´¥</option>
                        <option value="æ²³åŒ—">æ²³åŒ—</option>
                        <option value="ä¸Šæµ·">ä¸Šæµ·</option>
                        <option value="æ±Ÿè‹">æ±Ÿè‹</option>
                        <option value="æµ™æ±Ÿ">æµ™æ±Ÿ</option>
                        <option value="æ¹–å—">æ¹–å—</option>
                        <option value="æ¹–åŒ—">æ¹–åŒ—</option>
                        <option value="å››å·">å››å·</option>
                    </select>
                    <div class="hint">æŒ‰ä½ Ctrl/Cmd å¤šé€‰</div>
                </div>
                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('guideModal')">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜å¯¹æ¥äºº</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Toast -->
    <div class="toast" id="toast">ä¿å­˜æˆåŠŸï¼</div>
    
    <script>
        // æ•°æ®å­˜å‚¨
        let hospitals = [
            { id: 1, name: 'å¸¸å¾·æ¹˜é›…åŒ»é™¢', region: 'åä¸­', province: 'æ¹–å—', level: 'ä¸‰ç”²', guideId: 3, guideName: 'å¼ ä¼Ÿ' },
            { id: 2, name: 'æ·±åœ³æ¸¯å¤§åŒ»é™¢', region: 'åå—', province: 'å¹¿ä¸œ', level: 'ä¸‰ç”²', guideId: 2, guideName: 'ç‹èŠ³' },
            { id: 3, name: 'æ¹˜é›…åŒ»é™¢', region: 'åä¸­', province: 'æ¹–å—', level: 'ä¸‰ç”²', guideId: 3, guideName: 'å¼ ä¼Ÿ' },
            { id: 4, name: 'åŒ—äº¬åå’ŒåŒ»é™¢', region: 'ååŒ—', province: 'åŒ—äº¬', level: 'ä¸‰ç”²', guideId: 1, guideName: 'ææ˜' },
            { id: 5, name: '301åŒ»é™¢', region: 'ååŒ—', province: 'åŒ—äº¬', level: 'ä¸‰ç”²', guideId: 1, guideName: 'ææ˜' },
            { id: 6, name: 'åå±±åŒ»é™¢', region: 'åä¸œ', province: 'ä¸Šæµ·', level: 'ä¸‰ç”²', guideId: null, guideName: null },
        ];
        
        let guides = [
            { id: 1, name: 'ææ˜', phone: '+86 138-0011-0001', email: 'li.ming@apgmc.com', wechat: 'apgmc-liming', region: 'ååŒ—', province: ['åŒ—äº¬'], gender: 'male' },
            { id: 2, name: 'ç‹èŠ³', phone: '+86 138-0022-0002', email: 'wang.fang@apgmc.com', wechat: 'apgmc-wangfang', region: 'åå—', province: ['å¹¿ä¸œ'], gender: 'female' },
            { id: 3, name: 'å¼ ä¼Ÿ', phone: '+86 138-0033-0003', email: 'zhang.wei@apgmc.com', wechat: 'apgmc-zhangwei', region: 'åä¸­', province: ['æ¹–å—', 'æ¹–åŒ—'], gender: 'male' },
            { id: 4, name: 'é™ˆé™', phone: '+86 138-0044-0004', email: 'chen.jing@apgmc.com', wechat: 'apgmc-chenjing', region: 'åä¸œ', province: ['ä¸Šæµ·', 'æ±Ÿè‹'], gender: 'female' },
        ];
        
        let currentFilter = 'all';
        
        // æŒ‰åŒºåŸŸ+çœä»½åˆ†ç»„
        function getGroupedData() {
            const groups = {};
            
            // åˆå§‹åŒ–æ‰€æœ‰åŒºåŸŸå’Œçœä»½
            const regionProvinces = {
                'åå—': ['å¹¿ä¸œ', 'å¹¿è¥¿', 'æµ·å—'],
                'ååŒ—': ['åŒ—äº¬', 'å¤©æ´¥', 'æ²³åŒ—', 'å±±è¥¿', 'å†…è’™å¤'],
                'åä¸œ': ['ä¸Šæµ·', 'æ±Ÿè‹', 'æµ™æ±Ÿ', 'å®‰å¾½', 'ç¦å»º', 'æ±Ÿè¥¿', 'å±±ä¸œ'],
                'åè¥¿': ['å››å·', 'é‡åº†', 'è´µå·', 'äº‘å—', 'è¥¿è—', 'é™•è¥¿', 'ç”˜è‚ƒ', 'é’æµ·', 'å®å¤', 'æ–°ç–†'],
                'åä¸­': ['æ¹–å—', 'æ¹–åŒ—', 'æ²³å—']
            };
            
            for (const [region, provinces] of Object.entries(regionProvinces)) {
                if (currentFilter !== 'all' && currentFilter !== region) continue;
                
                for (const province of provinces) {
                    const key = `${region}-${province}`;
                    groups[key] = {
                        region,
                        province,
                        hospitals: [],
                        guides: []
                    };
                }
            }
            
            // å¡«å……æ•°æ®
            hospitals.forEach(h => {
                const key = `${h.region}-${h.province}`;
                if (groups[key]) groups[key].hospitals.push(h);
            });
            
            guides.forEach(g => {
                if (g.province && Array.isArray(g.province)) {
                    g.province.forEach(p => {
                        const key = `${g.region}-${p}`;
                        if (groups[key]) groups[key].guides.push(g);
                    });
                }
            });
            
            return groups;
        }
        
        // æ¸²æŸ“çœä»½å¡ç‰‡
        function renderProvinceCards() {
            const grid = document.getElementById('provinceGrid');
            const groups = getGroupedData();
            
            let html = '';
            let completeCount = 0;
            
            for (const [key, group] of Object.entries(groups)) {
                const hasHospital = group.hospitals.length > 0;
                const hasGuide = group.guides.length > 0;
                
                let status, statusText;
                if (hasHospital && hasGuide) {
                    status = 'complete';
                    statusText = 'âœ… å®Œæ•´åŒ¹é…';
                    completeCount++;
                } else if (hasHospital || hasGuide) {
                    status = 'partial';
                    statusText = 'âš ï¸ å¾…å®Œå–„';
                } else {
                    status = 'empty';
                    statusText = 'æœªé…ç½®';
                }
                
                // å¦‚æœéƒ½æ²¡æœ‰ï¼Œä¸æ˜¾ç¤º
                if (!hasHospital && !hasGuide) continue;
                
                html += `
                    <div class="province-card" data-region="${group.region}">
                        <div class="province-header">
                            <div class="province-name">${group.province}</div>
                            <div class="province-status status-${status}">${statusText}</div>
                        </div>
                        <div class="province-body">
                            <div class="mapping-row">
                                <div class="hospital-cell">
                                    <div class="cell-title">ğŸ¥ åŒ»é™¢</div>
                                    ${group.hospitals.length > 0 ? group.hospitals.map(h => `
                                        <div class="hospital-item">
                                            <div class="hospital-icon">ğŸ¥</div>
                                            <div class="hospital-info">
                                                <div class="hospital-name">${h.name}</div>
                                                <div class="hospital-tags">
                                                    <span class="tag">${h.level}</span>
                                                    ${h.guideName ? `<span class="tag" style="background:#10B981;color:white;">ğŸ‘¤ ${h.guideName}</span>` : ''}
                                                </div>
                                            </div>
                                        </div>
                                    `).join('') : '<div class="empty-state"><div class="empty-icon">ğŸ¥</div><p>æš‚æ— åŒ»é™¢</p></div>'}
                                </div>
                                <div class="guide-cell">
                                    <div class="cell-title">ğŸ‘¤ å¯¹æ¥äºº</div>
                                    ${group.guides.length > 0 ? group.guides.map(g => `
                                        <div class="guide-item">
                                            <div class="guide-avatar">${g.name[0]}</div>
                                            <div class="guide-info">
                                                <div class="guide-name">${g.name}</div>
                                                <div class="guide-contact">
                                                    <span>ğŸ“± ${g.phone}</span>
                                                    <span>âœ‰ï¸ ${g.email}</span>
                                                </div>
                                            </div>
                                        </div>
                                    `).join('') : '<div class="empty-state"><div class="empty-icon">ğŸ‘¤</div><p>æš‚æ— å¯¹æ¥äºº</p></div>'}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            grid.innerHTML = html || '<div class="empty-state"><div class="empty-icon">ğŸ“­</div><p>æš‚æ— æ•°æ®ï¼Œè¯·æ·»åŠ åŒ»é™¢æˆ–å¯¹æ¥äºº</p></div>';
            
            // æ›´æ–°ç»Ÿè®¡
            document.getElementById('totalHospitals').textContent = hospitals.length;
            document.getElementById('totalGuides').textContent = guides.length;
            document.getElementById('completeMatches').textContent = completeCount;
            
            const regions = new Set(hospitals.map(h => h.region));
            document.getElementById('totalRegions').textContent = regions.size || 0;
        }
        
        // ç­›é€‰åŒºåŸŸ
        function filterRegion(region) {
            currentFilter = region;
            document.querySelectorAll('.region-tab').forEach(tab => {
                tab.classList.toggle('active', tab.textContent === region || (region === 'all' && tab.textContent === 'å…¨éƒ¨'));
            });
            renderProvinceCards();
        }
        
        // æ‰“å¼€å¼¹çª—
        function openHospitalModal() {
            document.getElementById('hospitalModal').classList.add('open');
            updateGuideSelect();
        }
        
        function openGuideModal() {
            document.getElementById('guideModal').classList.add('open');
        }
        
        function closeModal(id) {
            document.getElementById(id).classList.remove('open');
        }
        
        // æ›´æ–°å¯¹æ¥äººä¸‹æ‹‰æ¡†
        function updateGuideSelect() {
            const select = document.getElementById('hospitalGuide');
            select.innerHTML = '<option value="">è¯·é€‰æ‹©å¯¹æ¥äººï¼ˆå¿…é€‰ï¼‰</option>' + 
                guides.map(g => `<option value="${g.id}">${g.name} (${g.region} ${g.phone})</option>`).join('');
        }
        
        // ä¿å­˜åŒ»é™¢
        function saveHospital(e) {
            e.preventDefault();
            const guideId = document.getElementById('hospitalGuide').value;
            if (!guideId) {
                alert('âš ï¸ å¿…é¡»é€‰æ‹©å¯¹æ¥äººï¼');
                return;
            }
            
            const guide = guides.find(g => g.id === parseInt(guideId));
            
            hospitals.push({
                id: Date.now(),
                name: document.getElementById('hospitalName').value,
                region: document.getElementById('hospitalRegion').value,
                province: document.getElementById('hospitalProvince').value,
                level: document.getElementById('hospitalLevel').value,
                guideId: parseInt(guideId),
                guideName: guide ? guide.name : null
            });
            
            closeModal('hospitalModal');
            renderProvinceCards();
            showToast('âœ… åŒ»é™¢æ·»åŠ æˆåŠŸï¼');
            e.target.reset();
        }
        
        // ä¿å­˜å¯¹æ¥äºº
        function saveGuide(e) {
            e.preventDefault();
            const provinceSelect = document.getElementById('guideProvince');
            const provinces = Array.from(provinceSelect.selectedOptions).map(o => o.value);
            
            guides.push({
                id: Date.now(),
                name: document.getElementById('guideName').value,
                phone: document.getElementById('guidePhone').value,
                email: document.getElementById('guideEmail').value,
                wechat: document.getElementById('guideWechat').value,
                region: document.getElementById('guideRegion').value,
                province: provinces,
                gender: document.getElementById('guideGender').value
            });
            
            closeModal('guideModal');
            renderProvinceCards();
            showToast('âœ… å¯¹æ¥äººæ·»åŠ æˆåŠŸï¼');
            e.target.reset();
        }
        
        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }
        
        // åˆå§‹åŒ–
        renderProvinceCards();
    </script>
</body>
</html>
